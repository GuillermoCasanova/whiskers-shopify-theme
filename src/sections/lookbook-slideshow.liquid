
<section class="lookBookSlideshow"  data-section-id="{{ section.id }}" data-section-type="lookbook_slideshow"  data-trigger> 
    <ul class="lookBookSlideshow-slideshow   grid  grid--center  grid--justifySpaceAround  med-grid--1of3" data-lookbook-slideshow>
      <li class="grid-cell  grid-cell--autoSize">
        <a href="/collections/solids/products/solid-light-blue"  title="Whiskers Light blue & Dark Blue Striped">
          <div class="lookBookSlideshow-look" data-look>
            <div class="lookbookSlideshow-look-image">
              <img data-size="auto" data-src="{{ 'look_1.jpg' | asset_url}}" alt="Light Blue Solids" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" data-look-img>
            </div>
            <span class="lookBookSlideshow-look-name">
              Solid Light Blue
            </span>
          </div>
        </a>
      </li>
      <li class="grid-cell  grid-cell--autoSize">
        <a href="/collections/striped/products/blue-light-blue-striped" title="Whiskers Light blue & Dark Blue Striped">
          <div class="lookBookSlideshow-look" data-look>
            <div class="lookbookSlideshow-look-image">
              <img  data-size="auto" data-src="{{ 'look_2.jpg' | asset_url}}" alt="Light blue & Dark Blue Striped" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" data-look-img>
            </div>
            <span class="lookBookSlideshow-look-name">
              Light blue & Dark Blue Striped
            </span>
          </div>
        </a>
      </li>
      <li class="grid-cell  grid-cell--autoSize">
        <a href="/collections/striped/products/solid-red" title="Red Solids">
        <div class="lookBookSlideshow-look" data-look>
          <div class="lookbookSlideshow-look-image">
            <img  data-size="auto" data-src="{{ 'look_3.jpg' | asset_url}}" alt="Red Solids" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" data-look-img>
          </div>
          <span class="lookBookSlideshow-look-name">
           Red Solids
          </span>
        </div>
        </a>
      </li>
      <li class="grid-cell  grid-cell--autoSize">
        <a href="/collections/diamond-weave/products/red-black-white-braided" title="Whiskers Black, Red & White Braided">
        <div class="lookBookSlideshow-look" data-look>
          <div class="lookbookSlideshow-look-image">
            <img  data-size="auto" data-src="{{ 'look_4.jpg' | asset_url}}" alt="Black, Red & white Braided" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" class="lazyload" data-look-img>
          </div>
          <span class="lookBookSlideshow-look-name">
            Black, Red & White Braided
          </span>
        </div>
      </a>
      </li>
    </ul>
    <div class="lookBookSlideshow-slideForMore  hide-for-large-up">
      Swipe right for more looks
    </div>
</section>


{%javascript %}
//<script>


  //
  // Self running function that handles all the animations and interactivity
  // of the first slideshow in the lookbook 
  //
  function lookBookSlideshow(container) { 

    var selectors = {
      lookbookSlideshow: '[data-lookbook-slideshow]',
      looks: '[data-look]'
    };
    var self = this; 

    this.$carousel = $(selectors.lookbookSlideshow); 
    this.animCtrl = null; 
    this.scrollScene = null; 
    this.reInitTimeout = null; 


    this.initInteractivity = function() {

      if(this.animCtrl) {
        this.animCtrl.destroy(this.scrollScene); 
        this.animCtrl.destroy();
        this.animCtrl = null; 
        this.scrollScene.destroy(); 
        this.scrollScene = null; 
        this.$carousel.removeAttr("style");
      }

      if(window.innerWidth < 641) {
        this.$carousel.removeClass("grid  grid--center  med-grid--justifySpaceAround  med-grid--1of3");
        this.$carousel.not('.slick-initialized').slick({
          'arrows': false,
          'slidesToShow': 1,
          'mobileFirst': true,
          'autoplaySpeed': 2500,
          'infinite': false,
          'centerPadding': '40px',
          'responsive' : [
              {
                breakpoint: 640, 
                settings: 'unslick'
              }
            ]
          });
          var nextBtn = $(container).find('.slick-next');
          var prevBtn = $(container).find('.slick-prev');
          nextBtn.text('');
          prevBtn.text('');
      } else {
        this.$carousel.addClass("grid  grid--center  med-grid--justifySpaceAround  med-grid--1of3");
        this.animCtrl = new ScrollMagic.Controller(); 
        var containerWidth = $(container).find(selectors.lookbookSlideshow).innerWidth(); 

        var wipeAnimation = new TimelineMax()
          .fromTo(selectors.lookbookSlideshow, 20, { x: "50%"}, { x: "-30%"});

        this.scrollScene = new ScrollMagic.Scene({
            triggerElement: '[data-trigger]',
            triggerHook: 'onLeave', 
            offset: -125,
            duration:  (containerWidth) + 'px'
          })
          .setPin(container)
          .setTween(wipeAnimation)
          .addTo(this.animCtrl); 

          setTimeout(function() {
            $(window).data('plugin_stellar').destroy();
            $(window).data('plugin_stellar').init();
          }, 400); 
      }

      self.setUpAnimations(); 
    }


    //
    // Sets up entry animations using the same animation controller 
    //
    this.setUpAnimations = function() {

      //
      // If theres no animation controller init, create one
      //
      if(!self.animCtrl) {
        self.animCtrl = new ScrollMagic.Controller(); 
      }
      //
      // Defines the entry animations for our looks
      //
      $(selectors.looks).each(function(index, element) {
        
        var look = element;

        TweenMax.set($(look).find('[data-look-img]'), {autoAlpha: 1});

        var lookEntry = new TimelineLite()
                .from($(look).find('[data-look-img]'), .3, {opacity: 0}, .04 * (index + 1));

        var lookScene = new ScrollMagic.Scene({
            triggerElement: look,
            triggerHook: 'onCenter',
            offset: 100, 
            reverse: false
          })
          .setTween(lookEntry)
          .addTo(self.animCtrl); 

      });
    }

    setTimeout(function() {
      self.initInteractivity(); 
    }, 200); 

    window.addEventListener('resize', function() {
      clearTimeout(self.reInitTimeout); 
      self.reInitTimeout = setTimeout(self.initInteractivity(), 1400); 
    }); 
  
  };

  lookbookSlideshow('[data-section-id="{{ section.id }}"]'); 

//</script>
{% endjavascript %}
